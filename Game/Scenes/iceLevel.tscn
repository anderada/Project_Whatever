[gd_scene load_steps=23 format=3 uid="uid://dhtt1sunmp6tr"]

[ext_resource type="MeshLibrary" uid="uid://dad42sw0f4afa" path="res://Assets/Tile Sets/tileSet.tres" id="1_nrea6"]
[ext_resource type="Script" path="res://Scripts/instancer.gd" id="2_26ana"]
[ext_resource type="PackedScene" uid="uid://cl782vs3tgpgy" path="res://Assets/Prefabs/invisible.tscn" id="3_w0d8i"]
[ext_resource type="Script" path="res://Scripts/animatePillars.gd" id="4_wia41"]
[ext_resource type="Script" path="res://Scripts/playerMovement.gd" id="5_txvlx"]
[ext_resource type="Environment" uid="uid://b6e7ydi8600yb" path="res://Assets/Environments/Library.tres" id="6_k86my"]
[ext_resource type="Script" path="res://Scripts/cameraMovement.gd" id="7_6qnms"]
[ext_resource type="Script" path="res://Scripts/actionable.gd" id="8_1unjb"]
[ext_resource type="Resource" uid="uid://bxg1svmf4p4tw" path="res://Dialogue/PillarClue.dialogue" id="9_2psa1"]
[ext_resource type="Script" path="res://Scripts/lookAtPlayer.gd" id="10_knadl"]
[ext_resource type="Material" uid="uid://bnj7x1ybf6fpy" path="res://Assets/Materials/Characters/test_character.tres" id="11_yu0rn"]

[sub_resource type="Curve" id="Curve_ay5xt"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(1, 1), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="Curve" id="Curve_5pkt8"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(1, 1), 1.4, 0.0, 0, 0]
point_count = 2

[sub_resource type="Curve" id="Curve_x6p1d"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(1, 1), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="Curve" id="Curve_mdgxm"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(1, 1), 1.4, 0.0, 0, 0]
point_count = 2

[sub_resource type="Curve" id="Curve_u7dom"]
_data = [Vector2(0, 0), 0.0, 1.0, 0, 1, Vector2(1, 1), 1.0, 0.0, 1, 0]
point_count = 2

[sub_resource type="Curve" id="Curve_kf3x4"]
_data = [Vector2(0, 0), 0.0, 1.4, 0, 0, Vector2(1, 1), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="Curve" id="Curve_ou3iv"]
_data = [Vector2(0, 0), 0.0, -0.245637, 0, 0, Vector2(0.321053, 0), 0.835163, 0.835163, 0, 0, Vector2(1, 1), 0.0, -1.04401, 0, 0]
point_count = 3

[sub_resource type="Curve" id="Curve_kfd2c"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(0.347368, 0.461538), 2.71429, 2.71429, 0, 0, Vector2(0.673684, 1), 0.0, 0.0, 0, 0, Vector2(0.857895, 0.285714), -4.42146, -4.42146, 0, 0, Vector2(1, 0), 0.0, 0.0, 0, 0]
point_count = 5

[sub_resource type="CylinderShape3D" id="CylinderShape3D_16tlw"]
height = 0.297069

[sub_resource type="BoxShape3D" id="BoxShape3D_p4702"]

[sub_resource type="PlaneMesh" id="PlaneMesh_8loid"]
size = Vector2(0.4, 0.8)
orientation = 0

[node name="Test Scene2" type="Node3D"]

[node name="Lights" type="Node" parent="."]

[node name="Sun" type="DirectionalLight3D" parent="Lights"]
transform = Transform3D(0.773345, -0.308728, 0.553737, -0.221585, 0.686715, 0.692332, -0.594002, -0.658111, 0.462658, 0, 0, 0)
light_energy = 0.3
shadow_enabled = true
shadow_bias = 0.0
shadow_normal_bias = 10.0
shadow_reverse_cull_face = true
shadow_opacity = 0.85
shadow_blur = 2.878

[node name="Ambient" type="DirectionalLight3D" parent="Lights"]
transform = Transform3D(-0.647531, 0.53143, -0.546154, -0.761076, -0.414986, 0.498549, 0.038299, 0.738491, 0.673176, 1, -1, 0)
visible = false
light_color = Color(0.811759, 0.698879, 0.638784, 1)
light_energy = 0.6

[node name="SpotLight3D" type="SpotLight3D" parent="Lights"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, -1.21575, 1.48268, -8.01378)
light_color = Color(0.829475, 0.897232, 0.911002, 1)
light_energy = 5.0
spot_range = 6.83
spot_angle = 37.31

[node name="SpotLight3D2" type="SpotLight3D" parent="Lights"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, -0.354054, 0.935778, -3.23595)
light_color = Color(0.829475, 0.897232, 0.911002, 1)
light_specular = 0.0
spot_range = 6.83
spot_attenuation = 0.0
spot_angle = 29.59
spot_angle_attenuation = 0.0688863

[node name="GridMap" type="GridMap" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.5, 0)
mesh_library = ExtResource("1_nrea6")
cell_size = Vector3(1, 1, 1)
cell_octant_size = 128
cell_center_x = false
cell_center_y = false
cell_center_z = false
cell_scale = 0.5
data = {
"cells": PackedInt32Array(-65537, 1, 2, -65537, 0, 2, -65537, 65535, 2, -131072, 65535, 2, -131072, 0, 2, -131071, 0, 2, -131072, 1, 2, -131071, 1, 2, -131071, 65535, 2, -2, 1, 1441793, -2, 0, 1441794, -2, 65535, 1441793, -65534, 65535, 1441793, -65534, 1, 1441793, -65534, 0, 1441794, -1, 2, 1441793, -65536, 2, 1441794, -65535, 2, 1441793, -131072, 65534, 1441793, -131072, 65533, 1441793, -131072, 65532, 1441793, -1, 65532, 1441792, -65535, 65532, 1441792, -65536, 65532, 1441799, -65534, 65533, 1441793, -65534, 65534, 1441794, -131071, 65534, 1441793, -131071, 65533, 1441793, -65537, 65533, 1441793, -65537, 65534, 1441793, -2, 65533, 1441793, -2, 65534, 1441794, -1, 1, 1441793, -65535, 1, 1441793, -1, 65531, 1, -1, 65530, 6, -65535, 65531, 1, -65535, 65530, 1, -65535, 65529, 1, -1, 65529, 1, -131072, 65531, 1, -131072, 65530, 1, -131072, 65529, 6, -131072, 65528, 6, -2, 65531, 6, -2, 65530, 6, -2, 65529, 0, -65537, 65528, 6, -65538, 65528, 6, -131072, 65527, 6, -131072, 65526, 6, -131071, 65528, 6, -131071, 65526, 1, -131070, 65526, 1, -131069, 65526, 1, -131070, 65527, 1, -131070, 65528, 1, -65534, 65529, 1, -1, 65527, 1, -65536, 65525, 0, -1, 65526, 1, -65535, 65525, 1, -65534, 65525, 2, -65533, 65527, 1, -65533, 65528, 1, -65532, 65526, 2, -65533, 65525, 1, -131071, 65527, 0, -65535, 65527, 0, -65537, 65529, 6, -131071, 65529, 6, -65537, 65527, 6, -65537, 65526, 6, -2, 65527, 1, -65538, 65527, 6, -65538, 65529, 6, -65535, 65534, 1048581, -65535, 65535, 1048580, -65539, 65528, 1, -65540, 65528, 1, -65540, 65527, 1, -65541, 65527, 1)
}
script = ExtResource("2_26ana")
pillarIndex = 7
hiddenPillarIndex = 8
pillarPrefab = ExtResource("3_w0d8i")
metadata/_editor_floor_ = Vector3(0, -2, 0)

[node name="pillarAnimator" type="Node" parent="GridMap"]
script = ExtResource("4_wia41")
animationTime = 0.1
activateCurve = SubResource("Curve_ay5xt")
deactivateCurve = SubResource("Curve_5pkt8")

[node name="GridMap2" type="GridMap" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10, -0.5, 0)
mesh_library = ExtResource("1_nrea6")
cell_size = Vector3(1, 1, 1)
cell_octant_size = 128
cell_center_x = false
cell_center_y = false
cell_center_z = false
cell_scale = 0.5
data = {
"cells": PackedInt32Array(-65537, 1, 2, -65537, 0, 2, -65537, 65535, 2, -131072, 65535, 2, -131072, 0, 2, -131071, 0, 2, -131072, 1, 2, -131071, 1, 2, -131071, 65535, 2, -2, 1, 1441793, -2, 0, 1441794, -2, 65535, 1441793, -65534, 65535, 1441793, -65534, 1, 1441793, -65534, 0, 1441794, -1, 2, 1441793, -65536, 2, 1441794, -65535, 2, 1441793, -131072, 65534, 1441793, -131072, 65533, 1441793, -131072, 65532, 1441793, -1, 65532, 1441792, -65535, 65532, 1441792, -65536, 65532, 1441799, -65534, 65533, 1441793, -65534, 65534, 1441794, -131071, 65534, 1441793, -131071, 65533, 1441793, -65537, 65533, 1441793, -65537, 65534, 1441793, -2, 65533, 1441793, -2, 65534, 1441794, -1, 1, 1441793, -65535, 1, 1441793, -1, 65531, 1, -1, 65530, 6, -65535, 65531, 1, -65535, 65530, 1, -65535, 65529, 1, -1, 65529, 1, -131072, 65531, 1, -131072, 65530, 1, -131072, 65529, 6, -131072, 65528, 6, -2, 65531, 6, -2, 65530, 6, -2, 65529, 0, -65537, 65528, 6, -65538, 65528, 6, -131072, 65527, 6, -131072, 65526, 6, -131071, 65528, 6, -131071, 65526, 1, -131070, 65526, 1, -131069, 65526, 1, -131070, 65527, 1, -131070, 65528, 1, -65534, 65529, 1, -1, 65527, 1, -65536, 65525, 0, -1, 65526, 1, -65535, 65525, 1, -65534, 65525, 2, -65532, 65526, 2, -65533, 65525, 1, -131071, 65527, 0, -65535, 65527, 0, -65537, 65529, 6, -131071, 65529, 6, -65537, 65527, 6, -65537, 65526, 6, -2, 65527, 1, -65538, 65527, 6, -65538, 65529, 6, -65535, 65534, 1048581, -65535, 65535, 1048580, -65539, 65528, 1, -65540, 65528, 1, -65540, 65527, 1, -131069, 65527, 1, -131068, 65527, 1, -131067, 65527, 1)
}
script = ExtResource("2_26ana")
pillarIndex = 7
hiddenPillarIndex = 8
pillarPrefab = ExtResource("3_w0d8i")
metadata/_editor_floor_ = Vector3(0, -1, 0)

[node name="pillarAnimator" type="Node" parent="GridMap2"]
script = ExtResource("4_wia41")
animationTime = 0.1
activateCurve = SubResource("Curve_ay5xt")
deactivateCurve = SubResource("Curve_5pkt8")

[node name="Player" type="Node3D" parent="."]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -2, 0)
script = ExtResource("5_txvlx")
moveTime = 0.35
walkCurve = SubResource("Curve_x6p1d")
slideInCurve = SubResource("Curve_mdgxm")
slideCurve = SubResource("Curve_u7dom")
slideOutCurve = SubResource("Curve_kf3x4")
rotationTime = 0.3
rotationCurve = SubResource("Curve_ou3iv")
mazeMaps = [NodePath("../GridMap"), NodePath("../GridMap2")]
iceIndex = 6
stairIndex = 4
pillarIndex = 8

[node name="Camera3D" type="Camera3D" parent="Player"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
environment = ExtResource("6_k86my")
fov = 70.0
near = 0.001
script = ExtResource("7_6qnms")
horizontalDegrees = 3.0
verticalDegrees = 15.0
cameraShake = SubResource("Curve_kfd2c")
cameraShakeIntensity = 0.1

[node name="Direction" type="Marker3D" parent="Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.745335, -1.04541)

[node name="ActionableFinder" type="Area3D" parent="Player/Direction"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Player/Direction/ActionableFinder"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.0448093, 0.389606)
shape = SubResource("CylinderShape3D_16tlw")

[node name="Label" type="Label" parent="."]
offset_left = 16.0
offset_top = 10.0
offset_right = 149.0
offset_bottom = 59.0
text = "W and S to move
A and D to rotate
"

[node name="Character" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1, -1, -2)

[node name="Actionable" type="Area3D" parent="Character"]
script = ExtResource("8_1unjb")
dialogue_resource = ExtResource("9_2psa1")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Character/Actionable"]
shape = SubResource("BoxShape3D_p4702")

[node name="Node3D" type="Node3D" parent="Character/Actionable/CollisionShape3D"]
script = ExtResource("10_knadl")
offset = 90.0

[node name="MeshInstance3D" type="MeshInstance3D" parent="Character/Actionable/CollisionShape3D/Node3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.4, -0.1, 0)
cast_shadow = 0
mesh = SubResource("PlaneMesh_8loid")
skeleton = NodePath("")
surface_material_override/0 = ExtResource("11_yu0rn")

[connection signal="pillarsInstanced" from="GridMap" to="GridMap/pillarAnimator" method="_on_grid_map_pillars_instanced"]
[connection signal="pillarsInstanced" from="GridMap2" to="GridMap2/pillarAnimator" method="_on_grid_map_pillars_instanced"]
[connection signal="activatePillar" from="Player" to="GridMap/pillarAnimator" method="_on_player_activate_pillar"]
[connection signal="activatePillar" from="Player" to="GridMap2/pillarAnimator" method="_on_player_activate_pillar"]
[connection signal="deactivatePillar" from="Player" to="GridMap/pillarAnimator" method="_on_player_deactivate_pillar"]
[connection signal="deactivatePillar" from="Player" to="GridMap2/pillarAnimator" method="_on_player_deactivate_pillar"]
[connection signal="startShake" from="Player" to="Player/Camera3D" method="_on_player_start_shake"]
[connection signal="input_event" from="Character/Actionable" to="Player" method="_on_actionable_input_event"]
